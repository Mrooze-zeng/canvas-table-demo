{"version":3,"sources":["components/Base.js","components/Ceil.js","components/Layer.js","components/Stage.js","components/Container.js","App.js","reportWebVitals.js","index.js"],"names":["Base","name","x","y","width","height","color","onFocus","this","originX","originY","listeners","Map","parent","draw","element","position","isInX","isInY","names","callback","split","forEach","set","trim","delete","args","get","Ceil","props","ctx","on","console","log","update","fillStyle","fillRect","setEvent","Layer","children","elments","concat","elment","setParent","type","isCurrentElement","trigger","updatePosition","Stage","canvas","document","createElement","getContext","layers","render","save","clearRect","layer","restore","wrapper","HTMLElement","querySelector","appendChild","Container","createRef","stage","state","inputLayerStyle","self","insertCanvas","addLayer","ceil_1","setState","display","top","left","zIndex","ceil_2","add","e","target","scrollTop","scrollLeft","getBoundingClientRect","clientX","clientY","preventDefault","stopPropagation","className","ref","el","onClick","handleClick","bind","onDoubleClick","handleDoubleClick","onContextMenu","handleContextMenu","style","onScroll","handleScroll","contentEditable","suppressContentEditableWarning","Component","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.ecaa2bd6.chunk.js","sourcesContent":["export default class Base {\n  constructor({\n    name = \"\",\n    x = 0,\n    y = 0,\n    width = 100,\n    height = 45,\n    color = \"yellow\",\n    onFocus = function () {},\n  }) {\n    this.name = name;\n    this.x = x;\n    this.y = y;\n    this.originX = x;\n    this.originY = y;\n    this.width = width;\n    this.height = height;\n    this.color = color;\n    this.onFocus = onFocus;\n    this.listeners = new Map();\n  }\n  update({\n    x = this.x,\n    y = this.y,\n    width = this.width,\n    height = this.height,\n    color = this.color,\n  }) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.color = color;\n    this.parent && this.parent.draw();\n  }\n  updatePosition(x = 0, y = 0) {\n    this.x = this.originX - x;\n    this.y = this.originY - y;\n  }\n  setParent(parent = null) {\n    this.parent = parent;\n  }\n  isCurrentElement(\n    element = { x: 0, y: 0, height: 0, width: 0 },\n    position = { x: 0, y: 0 },\n  ) {\n    let isInX =\n      position.x > element.x && position.x < element.x + element.width;\n    let isInY =\n      position.y > element.y && position.y < element.y + element.height;\n    return isInX && isInY;\n  }\n  on(names = \"\", callback = function () {}) {\n    names.split(\",\").forEach((name) => {\n      this.listeners.set(name.trim(), callback);\n    });\n  }\n  off(name = \"\") {\n    this.listeners.delete(name);\n  }\n  trigger(name = \"\", ...args) {\n    (\n      this.listeners.get(name) ||\n      function () {\n        return false;\n      }\n    )(name, ...args);\n  }\n}\n","import Base from \"./Base\";\nexport default class Ceil extends Base {\n  constructor(props = {}) {\n    super(props);\n    const { ctx, onFocus } = props;\n    this.ctx = ctx;\n    this.onFocus = onFocus;\n  }\n  setEvent() {\n    this.on(\"click\", (event = \"\", args = {}) => {\n      console.log(\"click on ceil\", this);\n      this.onFocus(this);\n    });\n    this.on(\"move\", (event = \"\", args = { x: 0, y: 0 }) => {\n      console.log(\"move...\", args);\n      this.update(args);\n    });\n  }\n  draw(x = 0, y = 0) {\n    this.ctx.fillStyle = this.color;\n    this.ctx.fillRect(this.x, this.y, this.width, this.height);\n    this.setEvent();\n  }\n}\n","import Base from \"./Base\";\n\nexport default class Layer extends Base {\n  constructor(props = {}) {\n    super(props);\n    const { ctx } = props;\n    this.ctx = ctx;\n    this.children = [];\n  }\n  add(...elments) {\n    this.children = this.children.concat(elments);\n    this.children.forEach((elment) => {\n      elment.setParent(this);\n    });\n    this.draw();\n    return this;\n  }\n  setEvent() {\n    this.on(\"click,move\", (type = \"\", args = {}) => {\n      this.children.forEach((elment) => {\n        elment.isCurrentElement(elment, args) && elment.trigger(type, args);\n      });\n    });\n  }\n  draw(x = 0, y = 0) {\n    this.ctx.fillStyle = this.color;\n    this.ctx.fillRect(this.x, this.y, this.width, this.height);\n    this.children.forEach((elment) => {\n      elment.updatePosition(x, y);\n      elment.draw(x, y);\n    });\n    this.setEvent();\n  }\n}\n","export default class Stage {\n  constructor({ width = 250, height = 250 }) {\n    this.width = width;\n    this.height = height;\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.width = width;\n    this.canvas.height = height;\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.children = [];\n  }\n  addLayer(...layers) {\n    this.children = this.children.concat = layers;\n    this.render();\n    return this;\n  }\n  render(x = 0, y = 0) {\n    this.ctx.save();\n    this.ctx.clearRect(0, 0, this.width, this.height);\n    // this.ctx.translate(x, y);\n    this.children.forEach((layer) => {\n      !layer.parent && layer.setParent(this);\n      layer.updatePosition(x, y);\n      layer.draw(x, y);\n    });\n    this.ctx.restore();\n  }\n  insertCanvas(wrapper = HTMLElement) {\n    if (!wrapper.querySelector(\"canvas\")) {\n      wrapper.appendChild(this.canvas);\n    }\n  }\n}\n","import { Component, createRef } from \"react\";\nimport Ceil from \"./Ceil\";\nimport Layer from \"./Layer\";\nimport Stage from \"./Stage\";\n\nexport default class Container extends Component {\n  constructor(props) {\n    super(props);\n    this.wrapper = createRef();\n    this.width = 450;\n    this.height = 350;\n    this.stage = new Stage({\n      width: this.width,\n      height: this.height,\n    });\n    this.state = {\n      inputLayerStyle: {},\n    };\n  }\n  componentDidMount() {\n    const self = this;\n    const layer = new Layer({ ...this.stage, color: \"green\" });\n    this.stage.insertCanvas(this.wrapper);\n    this.stage.addLayer(layer);\n    let ceil_1 = new Ceil({\n      x: 100,\n      y: 40,\n      width: 50,\n      height: 50,\n      ctx: this.stage.ctx,\n      onFocus: function ({ width = 0, height = 0, x = 0, y = 0 }) {\n        self.setState({\n          inputLayerStyle: {\n            display: \"inline-block\",\n            width,\n            height,\n            top: y,\n            left: x,\n            zIndex: 1,\n          },\n        });\n      },\n    });\n    let ceil_2 = new Ceil({\n      x: 10,\n      y: 10,\n      width: 25,\n      height: 25,\n      ctx: this.stage.ctx,\n      onFocus: function () {\n        self.setState({\n          inputLayerStyle: {\n            display: \"inline-block\",\n            width: this.width,\n            height: this.height,\n            top: this.y,\n            left: this.x,\n            zIndex: 1,\n          },\n        });\n      },\n    });\n    layer.add(ceil_1, ceil_2);\n  }\n  componentWillUnmount() {}\n  handleScroll(e) {\n    const { scrollTop, scrollLeft } = e.target;\n    console.log(scrollTop, scrollLeft, this.stage);\n    this.stage.render(scrollLeft, scrollTop);\n  }\n  handleClick(e) {\n    const { left, top } = e.target.getBoundingClientRect();\n    const x = e.clientX - left,\n      y = e.clientY - top;\n    this.stage.children.forEach((layer) => {\n      layer.isCurrentElement(layer, { x, y }) &&\n        layer.trigger(\"click\", { x, y });\n    });\n  }\n  handleDoubleClick() {\n    console.log(\"handleDoubleClick\");\n  }\n  handleContextMenu(e) {\n    console.log(\"handleContextMenu\");\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  render() {\n    const { inputLayerStyle } = this.state;\n    return (\n      <div\n        className=\"wrapper\"\n        ref={(el) => (this.wrapper = el)}\n        onClick={this.handleClick.bind(this)}\n        onDoubleClick={this.handleDoubleClick.bind(this)}\n        onContextMenu={this.handleContextMenu.bind(this)}\n      >\n        <div className=\"wrapper-scroll\">\n          <div\n            className=\"wrapper-scroll-inner\"\n            style={{\n              width: this.width + 10,\n              height: this.height + 10,\n            }}\n            onScroll={this.handleScroll.bind(this)}\n          >\n            <div className=\"wrapper-scroll-end\"></div>\n            <div\n              className=\"input-placeholder\"\n              style={inputLayerStyle}\n              onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n              }}\n              contentEditable={true}\n              suppressContentEditableWarning={true}\n            >\n              hello world\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import \"./App.css\";\nimport Container from \"./components/Container\";\n\nfunction App() {\n  return <Container />;\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
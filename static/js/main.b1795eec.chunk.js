(this["webpackJsonpcanvas-demo"]=this["webpackJsonpcanvas-demo"]||[]).push([[0],{12:function(t,e,i){},13:function(t,e,i){},15:function(t,e,i){"use strict";i.r(e);var n=i(3),h=i.n(n),o=i(7),s=i.n(o),r=(i(12),i(13),i(1)),a=i(2),c=i(5),l=i(4),d=function(){function t(e){var i=e.name,n=void 0===i?"":i,h=e.x,o=void 0===h?0:h,s=e.y,a=void 0===s?0:s,c=e.width,l=void 0===c?100:c,d=e.height,u=void 0===d?45:d,v=e.color,f=void 0===v?"yellow":v,g=e.fixed,y=void 0===g?"":g,p=e.onFocus,x=void 0===p?function(){}:p,w=e.onScroll,b=void 0===w?function(){}:w;Object(r.a)(this,t),this.name=n,this.x=o,this.y=a,this.originX=o,this.originY=a,this.width=l,this.height=u,this.color=f,this.fixed=y,this.onFocus=x,this.onScroll=b,this.listeners=new Map}return Object(a.a)(t,[{key:"update",value:function(t){var e=t.x,i=void 0===e?this.x:e,n=t.y,h=void 0===n?this.y:n,o=t.width,s=void 0===o?this.width:o,r=t.height,a=void 0===r?this.height:r,c=t.color,l=void 0===c?this.color:c;this.x=i,this.y=h,this.width=s,this.height=a,this.color=l,this.parent&&this.parent.draw()}},{key:"updatePosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(this.fixed){case"top":this.x=this.originX-t,this.y=0;break;case"left":this.x=0,this.y=this.originY-e;break;default:this.x=this.originX-t,this.y=this.originY-e}this.onScroll(this)}},{key:"setParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.parent=t}},{key:"isCurrentElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,height:0,width:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=e.x>t.x&&e.x<t.x+t.width,n=e.y>t.y&&e.y<t.y+t.height;return i&&n}},{key:"on",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e.split(",").forEach((function(e){t.listeners.set(e.trim(),i)}))}},{key:"off",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.listeners.delete(t)}},{key:"trigger",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];(this.listeners.get(t)||function(){return!1}).apply(void 0,[t].concat(i))}}]),t}(),u=function(t){Object(c.a)(i,t);var e=Object(l.a)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,i),t=e.call(this,n);var h=n.ctx,o=n.onFocus;return t.ctx=h,t.onFocus=o,t}return Object(a.a)(i,[{key:"setEvent",value:function(){var t=this;this.on("click",(function(){console.log("click on ceil",t),t.onFocus(t)})),this.on("move",(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};console.log("move...",e),t.update(e)}))}},{key:"draw",value:function(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.fillStyle="#000",this.ctx.font="16px -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;",this.ctx.fillText(this.name,this.x+25,this.y+25),this.setEvent()}}]),i}(d),v=function(t){Object(c.a)(i,t);var e=Object(l.a)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,i),t=e.call(this,n);var h=n.ctx;return t.ctx=h,t.children=[],t}return Object(a.a)(i,[{key:"add",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this.children=this.children.concat(i),this.children.forEach((function(e){e.setParent(t)})),this.draw(),this}},{key:"setEvent",value:function(){var t=this;this.on("click,move",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.children.forEach((function(t){t.isCurrentElement(t,i)&&t.trigger(e,i)}))}))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height),this.children.forEach((function(i){i.updatePosition(t,e),i.draw(t,e)})),this.setEvent()}}]),i}(d),f=function(){function t(e){var i=e.width,n=void 0===i?250:i,h=e.height,o=void 0===h?250:h;Object(r.a)(this,t),this.width=n,this.height=o,this.canvas=document.createElement("canvas"),this.canvas.width=n,this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.children=[]}return Object(a.a)(t,[{key:"addLayer",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.children=this.children.concat(e).reverse(),this.render(),this}},{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ctx.save(),this.ctx.clearRect(0,0,this.width,this.height),this.children.forEach((function(n){!n.parent&&n.setParent(t),n.updatePosition(e,i),n.draw(e,i)})),this.ctx.restore()}},{key:"insertCanvas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:HTMLElement;t.querySelector("canvas")||t.appendChild(this.canvas)}}]),t}(),g=i(0),y=function(t){Object(c.a)(i,t);var e=Object(l.a)(i);function i(t){var h;return Object(r.a)(this,i),(h=e.call(this,t)).wrapper=Object(n.createRef)(),h.inputLayer=Object(n.createRef)(),h.width=450,h.height=350,h.stage=new f({width:h.width,height:h.height}),h.state={inputLayerStyle:{},currentText:""},h}return Object(a.a)(i,[{key:"componentDidMount",value:function(){var t=new v({name:"body",x:0,y:45,ctx:this.stage.ctx,width:10*this.width,height:10*this.height,color:"white"}),e=new v({name:"header",x:0,y:0,ctx:this.stage.ctx,width:10*this.width,height:45,color:"white",fixed:"top"});this.stage.insertCanvas(this.wrapper),this.stage.addLayer(e,t),this._createCeil({size:50,initX:0,initY:0,layer:e,color:"orange"});for(var i=0;i<75;i++)this._createCeil({size:50,initX:0,initY:45+46*i,layer:t,row:i+1})}},{key:"_createCeil",value:function(t){for(var e=t.size,i=void 0===e?10:e,n=t.initX,h=void 0===n?0:n,o=t.initY,s=void 0===o?0:o,r=t.width,a=void 0===r?100:r,c=t.layer,l=void 0===c?null:c,d=t.color,v=void 0===d?"green":d,f=t.row,g=void 0===f?0:f,y=this,p=[],x=0;x<i;x++){var w=h+x*(a+1),b=s;p.push(new u({name:"\u5217".concat(x,"-\u884c").concat(g),x:w,y:b,width:100,height:45,ctx:this.stage.ctx,color:v,fixed:l.fixed,onFocus:function(){y.updateInputLayer.call(y,this)},onScroll:function(){y.updateInputLayer.call(y,this,!1)}}))}l.add.apply(l,p)}},{key:"updateInputLayer",value:function(t){var e=this,i=t.width,n=void 0===i?0:i,h=t.height,o=void 0===h?0:h,s=t.x,r=void 0===s?0:s,a=t.y,c=void 0===a?0:a,l=t.name,d=void 0===l?"":l,u=t.color,v=void 0===u?"orange":u,f=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({inputLayerStyle:{display:f?"inline-block":"none",width:n,height:o,top:c,left:r,zIndex:1,background:v},currentText:d}),f&&setTimeout((function(){e.inputLayer.focus()}))}},{key:"handleScroll",value:function(t){var e=t.target,i=e.scrollTop,n=e.scrollLeft;this.stage.render(n,i)}},{key:"handleClick",value:function(t){var e=t.target.getBoundingClientRect(),i=e.left,n=e.top,h=t.clientX-i,o=t.clientY-n;this.stage.children.forEach((function(t){t.isCurrentElement(t,{x:h,y:o})&&t.trigger("click",{x:h,y:o})}))}},{key:"handleDoubleClick",value:function(){console.log("handleDoubleClick")}},{key:"handleContextMenu",value:function(t){console.log("handleContextMenu"),t.preventDefault(),t.stopPropagation()}},{key:"handleBlur",value:function(){this.updateInputLayer({},!1)}},{key:"render",value:function(){var t=this,e=this.state,i=e.inputLayerStyle,n=e.currentText;return Object(g.jsx)("div",{className:"wrapper",ref:function(e){return t.wrapper=e},onClick:this.handleClick.bind(this),onBlur:this.handleBlur.bind(this),onDoubleClick:this.handleDoubleClick.bind(this),onContextMenu:this.handleContextMenu.bind(this),children:Object(g.jsx)("div",{className:"wrapper-scroll",children:Object(g.jsxs)("div",{className:"wrapper-scroll-inner",style:{width:this.width+10,height:this.height+10},onScroll:this.handleScroll.bind(this),children:[Object(g.jsx)("div",{className:"wrapper-scroll-end",style:{top:10*this.height,left:10*this.width}}),Object(g.jsx)("div",{className:"input-placeholder",ref:function(e){return t.inputLayer=e},style:i,onClick:function(t){t.preventDefault(),t.stopPropagation()},contentEditable:!0,suppressContentEditableWarning:!0,children:n})]})})})}}]),i}(n.Component);var p=function(){return Object(g.jsx)(y,{})},x=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,16)).then((function(e){var i=e.getCLS,n=e.getFID,h=e.getFCP,o=e.getLCP,s=e.getTTFB;i(t),n(t),h(t),o(t),s(t)}))};s.a.render(Object(g.jsx)(h.a.StrictMode,{children:Object(g.jsx)(p,{})}),document.getElementById("root")),x()}},[[15,1,2]]]);
//# sourceMappingURL=main.b1795eec.chunk.js.map
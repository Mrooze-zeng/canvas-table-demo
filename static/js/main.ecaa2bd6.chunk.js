(this["webpackJsonpcanvas-demo"]=this["webpackJsonpcanvas-demo"]||[]).push([[0],{13:function(t,e,i){},14:function(t,e,i){},16:function(t,e,i){"use strict";i.r(e);var n=i(3),h=i.n(n),o=i(8),s=i.n(o),c=(i(13),i(14),i(7)),a=i(1),r=i(2),l=i(5),d=i(4),u=function(){function t(e){var i=e.name,n=void 0===i?"":i,h=e.x,o=void 0===h?0:h,s=e.y,c=void 0===s?0:s,r=e.width,l=void 0===r?100:r,d=e.height,u=void 0===d?45:d,v=e.color,g=void 0===v?"yellow":v,f=e.onFocus,y=void 0===f?function(){}:f;Object(a.a)(this,t),this.name=n,this.x=o,this.y=c,this.originX=o,this.originY=c,this.width=l,this.height=u,this.color=g,this.onFocus=y,this.listeners=new Map}return Object(r.a)(t,[{key:"update",value:function(t){var e=t.x,i=void 0===e?this.x:e,n=t.y,h=void 0===n?this.y:n,o=t.width,s=void 0===o?this.width:o,c=t.height,a=void 0===c?this.height:c,r=t.color,l=void 0===r?this.color:r;this.x=i,this.y=h,this.width=s,this.height=a,this.color=l,this.parent&&this.parent.draw()}},{key:"updatePosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=this.originX-t,this.y=this.originY-e}},{key:"setParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.parent=t}},{key:"isCurrentElement",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,height:0,width:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},i=e.x>t.x&&e.x<t.x+t.width,n=e.y>t.y&&e.y<t.y+t.height;return i&&n}},{key:"on",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e.split(",").forEach((function(e){t.listeners.set(e.trim(),i)}))}},{key:"off",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.listeners.delete(t)}},{key:"trigger",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];(this.listeners.get(t)||function(){return!1}).apply(void 0,[t].concat(i))}}]),t}(),v=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,i),t=e.call(this,n);var h=n.ctx,o=n.onFocus;return t.ctx=h,t.onFocus=o,t}return Object(r.a)(i,[{key:"setEvent",value:function(){var t=this;this.on("click",(function(){console.log("click on ceil",t),t.onFocus(t)})),this.on("move",(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0};console.log("move...",e),t.update(e)}))}},{key:"draw",value:function(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height),this.setEvent()}}]),i}(u),g=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,i),t=e.call(this,n);var h=n.ctx;return t.ctx=h,t.children=[],t}return Object(r.a)(i,[{key:"add",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return this.children=this.children.concat(i),this.children.forEach((function(e){e.setParent(t)})),this.draw(),this}},{key:"setEvent",value:function(){var t=this;this.on("click,move",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.children.forEach((function(t){t.isCurrentElement(t,i)&&t.trigger(e,i)}))}))}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height),this.children.forEach((function(i){i.updatePosition(t,e),i.draw(t,e)})),this.setEvent()}}]),i}(u),f=function(){function t(e){var i=e.width,n=void 0===i?250:i,h=e.height,o=void 0===h?250:h;Object(a.a)(this,t),this.width=n,this.height=o,this.canvas=document.createElement("canvas"),this.canvas.width=n,this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.children=[]}return Object(r.a)(t,[{key:"addLayer",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.children=this.children.concat=e,this.render(),this}},{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ctx.save(),this.ctx.clearRect(0,0,this.width,this.height),this.children.forEach((function(n){!n.parent&&n.setParent(t),n.updatePosition(e,i),n.draw(e,i)})),this.ctx.restore()}},{key:"insertCanvas",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:HTMLElement;t.querySelector("canvas")||t.appendChild(this.canvas)}}]),t}(),y=i(0),p=function(t){Object(l.a)(i,t);var e=Object(d.a)(i);function i(t){var h;return Object(a.a)(this,i),(h=e.call(this,t)).wrapper=Object(n.createRef)(),h.width=450,h.height=350,h.stage=new f({width:h.width,height:h.height}),h.state={inputLayerStyle:{}},h}return Object(r.a)(i,[{key:"componentDidMount",value:function(){var t=this,e=new g(Object(c.a)(Object(c.a)({},this.stage),{},{color:"green"}));this.stage.insertCanvas(this.wrapper),this.stage.addLayer(e);var i=new v({x:100,y:40,width:50,height:50,ctx:this.stage.ctx,onFocus:function(e){var i=e.width,n=void 0===i?0:i,h=e.height,o=void 0===h?0:h,s=e.x,c=void 0===s?0:s,a=e.y,r=void 0===a?0:a;t.setState({inputLayerStyle:{display:"inline-block",width:n,height:o,top:r,left:c,zIndex:1}})}}),n=new v({x:10,y:10,width:25,height:25,ctx:this.stage.ctx,onFocus:function(){t.setState({inputLayerStyle:{display:"inline-block",width:this.width,height:this.height,top:this.y,left:this.x,zIndex:1}})}});e.add(i,n)}},{key:"componentWillUnmount",value:function(){}},{key:"handleScroll",value:function(t){var e=t.target,i=e.scrollTop,n=e.scrollLeft;console.log(i,n,this.stage),this.stage.render(n,i)}},{key:"handleClick",value:function(t){var e=t.target.getBoundingClientRect(),i=e.left,n=e.top,h=t.clientX-i,o=t.clientY-n;this.stage.children.forEach((function(t){t.isCurrentElement(t,{x:h,y:o})&&t.trigger("click",{x:h,y:o})}))}},{key:"handleDoubleClick",value:function(){console.log("handleDoubleClick")}},{key:"handleContextMenu",value:function(t){console.log("handleContextMenu"),t.preventDefault(),t.stopPropagation()}},{key:"render",value:function(){var t=this,e=this.state.inputLayerStyle;return Object(y.jsx)("div",{className:"wrapper",ref:function(e){return t.wrapper=e},onClick:this.handleClick.bind(this),onDoubleClick:this.handleDoubleClick.bind(this),onContextMenu:this.handleContextMenu.bind(this),children:Object(y.jsx)("div",{className:"wrapper-scroll",children:Object(y.jsxs)("div",{className:"wrapper-scroll-inner",style:{width:this.width+10,height:this.height+10},onScroll:this.handleScroll.bind(this),children:[Object(y.jsx)("div",{className:"wrapper-scroll-end"}),Object(y.jsx)("div",{className:"input-placeholder",style:e,onClick:function(t){t.preventDefault(),t.stopPropagation()},contentEditable:!0,suppressContentEditableWarning:!0,children:"hello world"})]})})})}}]),i}(n.Component);var x=function(){return Object(y.jsx)(p,{})},w=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,17)).then((function(e){var i=e.getCLS,n=e.getFID,h=e.getFCP,o=e.getLCP,s=e.getTTFB;i(t),n(t),h(t),o(t),s(t)}))};s.a.render(Object(y.jsx)(h.a.StrictMode,{children:Object(y.jsx)(x,{})}),document.getElementById("root")),w()}},[[16,1,2]]]);
//# sourceMappingURL=main.ecaa2bd6.chunk.js.map